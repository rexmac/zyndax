(function(a){function t(g,b){var c=a(g).text().toUpperCase(),e=a(b).text().toUpperCase();return c<e?-1:c>e?1:0}var q={init:function(g){var b={selectedPosition:"right",moveOptions:!1,labelTop:"Top",labelBottom:"Bottom",labelUp:"Up",labelDown:"Down",labelSort:"Sort",labelsx:"Available",labeldx:"Selected",maxSelected:-1,autoSort:!0,autoSortAvailable:!0,autoSortFunction:null,search:"Search...",caseSensitive:!1,delay:200,optGroupSearch:!1,minSize:6};return this.each(function(){var c=a(this),e=c.data("multiselect2side");
g&&a.extend(b,g);e||c.data("multiselect2side",b);var i=a(this).attr("name");-1!=i.indexOf("[")&&(i=i.substring(0,i.indexOf("[")));var e=i+"ms2side__dx",i=i+"ms2side__sx",k=a(this).attr("size");k<b.minSize&&(a(this).attr("size",""+b.minSize),k=b.minSize);var q="<div class='ms2side__updown'><p class='SelSort' title='Sort'>"+b.labelSort+"</p><p class='MoveTop' title='Move on top selected option'>"+b.labelTop+"</p><p class='MoveUp' title='Move up selected option'>"+b.labelUp+"</p><p class='MoveDown' title='Move down selected option'>"+
b.labelDown+"</p><p class='MoveBottom' title='Move on bottom selected option'>"+b.labelBottom+"</p></div>",m=!1,o=!1;if(!1!==b.search&&!1!==b.optGroupSearch){var l=b.optGroupSearch+"<select class='small' ><option value=__null__> </option></select> <input class='small search ui-widget-content ui-corner-all' type='search' placeholder='"+b.search+"'/><a href='#'> </a>";"right"===b.selectedPosition?m=l:o=l}else!1!==b.search?(l="<input class='search ui-widget-content ui-corner-all' type='search' placeholder=' "+
b.search+"' results='5'/><a href='#'> </a>","right"===b.selectedPosition?m=l:o=l):!1!==b.optGroupSearch&&(l=b.optGroupSearch+"<select><option value=__null__> </option></select>","right"===b.selectedPosition?m=l:o=l);c.after("<div class='ms2side__div ui-widget'>"+("right"!==b.selectedPosition&&b.moveOptions?q:"")+"<div class='ms2side__select ui-widget-content ui-corner-all'>"+(b.labelsx||!1!==m?"<div class='ms2side__header ui-helper-clearfix ui-widget-header'><span class='count'>"+b.labelsx+"</span>"+
(!1!==m?m:"")+"</div>":"")+"<select class='ui-widget-content ui-corner-all' title='"+b.labelsx+"' name='"+i+"' id='"+i+"' size='"+k+"' multiple='multiple' ></select></div><div class='ms2side__options'>"+("right"===b.selectedPosition?"<button class='AddOne ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only' title='Add Selected' role='button' aria-disabled='false'><span class='ui-button-text'>&rsaquo;</span></button><button class='AddAll ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only' title='Add All' role='button' aria-disabled='false'><span class='ui-button-text'>&raquo;</span></button><button class='RemoveOne ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only' title='Remove Selected' role='button' aria-disabled='false'><span class='ui-button-text'>&lsaquo;</span></button><button class='RemoveAll ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only' title='Remove All' role='button' aria-disabled='false'><span class='ui-button-text'>&laquo;</span></button>":
"<button class='AddOne ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only' title='Add Selected' role='button' aria-disabled='false'><span class='ui-button-text'>&lsaquo;</span></button><button class='AddAll ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only' title='Add All' role='button' aria-disabled='false'><span class='ui-button-text'>&laquo;</span></button><button class='RemoveOne ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only' title='Remove Selected' role='button' aria-disabled='false'><span class='ui-button-text'>&rsaquo;</span></button><button class='RemoveAll ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only' title='Remove All' role='button' aria-disabled='false'><span class='ui-button-text'>&raquo;</span></button>")+
"</div><div class='ms2side__select ui-widget-content ui-corner-all'>"+(b.labeldx||!1!==o?"<div class='ms2side__header ui-helper-clearfix ui-widget-header'><span class='count'>"+b.labeldx+"</span>"+(!1!==o?o:"")+"</div>":"")+"<select class='ui-widget-content ui-corner-all' title='"+b.labeldx+"' name='"+e+"' id='"+e+"' size='"+k+"' multiple='multiple' ></select></div>"+("right"===b.selectedPosition&&b.moveOptions?q:"")+"</div>").hide();var e=c.next().children(".ms2side__select").children("select"),
d="right"===b.selectedPosition?e.eq(0):e.eq(1),h="right"===b.selectedPosition?e.eq(1):e.eq(0),j=a(),n=a(this).next().find("input.search"),r=n.next().hide(),s=!1,p=!1;if(!1!==b.optGroupSearch){var u=!1,j=a(this).next().find("select").eq(0);c.children("optgroup").each(function(){j.find("[value='"+a(this).attr("label")+"']").size()===0&&j.append("<option value='"+a(this).attr("label")+"'>"+a(this).attr("label")+"</option>")});j.change(function(){var b=a(this);if(b.val()!=u){if(n.val()!==""){clearTimeout(s);
n.val("");p=""}setTimeout(function(){els=b.val()=="__null__"?c.find("option:not(:selected)"):c.find("optgroup[label='"+b.val()+"']").children("option:not(:selected)");d.find("option").remove();els.each(function(){d.append(a(this).clone())});u=b.val();d.trigger("change")},100)}})}var v=function(){d.children();var f=c.find("option:not(:selected)");u="__null__";j.val("__null__");if(p!=n.val()){p=n.val();setTimeout(function(){d.children().remove();if(p==="")f.clone().appendTo(d).removeAttr("selected");
else{f.each(function(){var c=a(this).text();find=b.caseSensitive?c.indexOf(p):c.toUpperCase().indexOf(p.toUpperCase());find!==-1&&a(this).clone().appendTo(d).removeAttr("selected")});d.trigger("change")}d.trigger("change")},5)}};r.click(function(){clearTimeout(s);n.val("");v();return false});n.keyup(function(){clearTimeout(s);s=setTimeout(v,b.delay)});n.click(function(b){var c=a(this),d=c.offset();if(c.val()===""&&b.pageX>d.left+c.width()-16){r.click();a(this).blur()}});a(this).find("option:selected").clone().appendTo(h);
a(this).find("option:not(:selected)").clone().appendTo(d);a.browser.msie&&"6.0"==a.browser.version||(d.find("option").eq(0).attr("selected",!0),h.children().removeAttr("selected"));var w=0;b.autoSort&&e.change(function(){var f=h.find("option");if(f.length!=w){f.sort(b.autoSortFunction||t);c.find("option:selected").remove();f.each(function(){h.append(a(this).clone());a(this).appendTo(c).attr("selected",true)});w=f.length}});var x=0;b.autoSortAvailable&&e.change(function(){var c=d.find("option");if(c.length!=
x){c.sort(b.autoSortFunction||t);d.find("option").remove();c.each(function(){d.append(a(this).clone())});x=c.length}});e.change(function(){d.parent().find("span.count").html(b.labelsx+" ("+d.find("option").length+")");h.parent().find("span.count").html(b.labeldx+" ("+h.find("option").length+")")});e.change(function(){a.browser.msie&&a.browser.version=="6.0"&&c.show().hide();var f=a(this).parent().parent(),e=d.children(),g=h.children(),i=d.find("option:selected"),j=h.find("option:selected");i.size()===
0||b.maxSelected>=0&&i.size()+g.size()>b.maxSelected?f.find(".AddOne").addClass("ms2side__hide ui-state-disabled"):f.find(".AddOne").removeClass("ms2side__hide ui-state-disabled");f.find(".RemoveOne, .MoveUp, .MoveDown, .MoveTop, .MoveBottom, .SelSort").addClass("ms2side__hide ui-state-disabled");g.size()>1&&f.find(".SelSort").removeClass("ms2side__hide ui-state-disabled");if(j.size()>0){f.find(".RemoveOne").removeClass("ms2side__hide ui-state-disabled");if(j.size()<g.size()){j.val()!=g.val()&&f.find(".MoveUp, .MoveTop").removeClass("ms2side__hide ui-state-disabled");
j.last().val()!=g.last().val()&&f.find(".MoveDown, .MoveBottom").removeClass("ms2side__hide ui-state-disabled")}}e.size()===0||b.maxSelected>=0&&e.size()>=b.maxSelected?f.find(".AddAll").addClass("ms2side__hide ui-state-disabled"):f.find(".AddAll").removeClass("ms2side__hide ui-state-disabled");g.size()===0?f.find(".RemoveAll").addClass("ms2side__hide ui-state-disabled"):f.find(".RemoveAll").removeClass("ms2side__hide ui-state-disabled")});d.dblclick(function(){a(this).find("option:selected").each(function(f,
d){if(b.maxSelected<0||h.children().size()<b.maxSelected){a(this).remove().appendTo(h);c.find("[value="+a(d).val()+"]").remove().appendTo(c).attr("selected",true)}});a(this).trigger("change")});h.dblclick(function(){a(this).find("option:selected").each(function(b,e){a(this).remove().appendTo(d);c.find("[value="+a(e).val()+"]").removeAttr("selected").remove().appendTo(c)});a(this).trigger("change");r.click();j.val("__null__").trigger("change")});a(this).next().find(".ms2side__options").children().blur(function(){a(this).removeClass("ui-state-focus")}).focus(function(){a(this).hasClass("ui-state-disabled")||
a(this).addClass("ui-state-focus")}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});a(this).next().find(".ms2side__options").children().click(function(b){if(!a(this).hasClass("ms2side__hide")){a(this).addClass("ui-state-highlight");if(a(this).hasClass("AddOne"))d.find("option:selected").each(function(b,d){a(this).remove().appendTo(h);c.find("[value="+a(d).val()+"]").remove().appendTo(c).attr("selected",
true)});else if(a(this).hasClass("AddAll"))if(j.length>0&&j.val()!="__null__")d.children().each(function(b,d){a(this).remove().appendTo(h);c.find("[value="+a(d).val()+"]").remove().appendTo(c).attr("selected",true)});else{d.children().remove().appendTo(h);c.find("option").attr("selected",true)}else if(a(this).hasClass("RemoveOne")){h.find("option:selected").each(function(b,f){a(this).remove().appendTo(d);c.find("[value="+a(f).val()+"]").remove().appendTo(c).removeAttr("selected")});r.click();j.val("__null__").trigger("change")}else if(a(this).hasClass("RemoveAll")){h.children().appendTo(d);
h.children().remove();c.find("option").removeAttr("selected");r.click();j.val("__null__").trigger("change")}var e=this;setTimeout(function(){a(e).removeClass("ui-state-highlight")},100)}d.trigger("change");b.preventDefault()});a(this).next().find(".ms2side__updown").children().click(function(){var f=h.find("option:selected"),e=h.find("option");if(!a(this).hasClass("ms2side__hide"))if(a(this).hasClass("SelSort")){e.sort(b.autoSortFunction||t);c.find("option:selected").remove();e.each(function(){h.append(a(this).clone().attr("selected",
true));c.append(a(this).attr("selected",true))})}else if(a(this).hasClass("MoveUp")){var g=f.first().prev(),i=c.find("[value="+g.val()+"]");f.each(function(){a(this).insertBefore(g);c.find("[value="+a(this).val()+"]").insertBefore(i)})}else if(a(this).hasClass("MoveDown")){var j=f.last().next(),k=c.find("[value="+j.val()+"]");f.each(function(){a(this).insertAfter(j);c.find("[value="+a(this).val()+"]").insertAfter(k)})}else if(a(this).hasClass("MoveTop")){var l=e.first(),n=c.find("[value="+l.val()+
"]");f.each(function(){a(this).insertBefore(l);c.find("[value="+a(this).val()+"]").insertBefore(n)})}else if(a(this).hasClass("MoveBottom")){var m=e.last(),o=c.find("[value="+m.val()+"]");f.each(function(){m=a(this).insertAfter(m);o=c.find("[value="+a(this).val()+"]").insertAfter(o)})}d.trigger("change")});a(this).next().find(".ms2side__options, .ms2side__updown").children().hover(function(){a(this).addClass("ms2side_hover")},function(){a(this).removeClass("ms2side_hover")});var y=a(".ms2side__select").eq(0).height();
a(this).next().find(".ms2side__options, .ms2side__updown").each(function(){var b=(y-a(this).height())/2;b>0&&a(this).css("padding-top",b+"px")});d.trigger("change");a(this).next().show()})},destroy:function(){return this.each(function(){var g=a(this);g.data("multiselect2side")&&g.show().next().remove()})},addOption:function(g){var b={name:!1,value:!1,selected:!1};return this.each(function(){var c=a(this),e=c.data("multiselect2side");if(e){g&&a.extend(b,g);var i="<option value='"+b.name+"' "+(b.selected?
"selected":"")+" >"+b.name+"</option>";c.append(i);var k=c.next().children(".ms2side__select").children("select"),c="right"==e.selectedPosition?k.eq(0):k.eq(1),e="right"==e.selectedPosition?k.eq(1):k.eq(0);b.selected?e.append(i).trigger("change"):c.append(i).trigger("change")}})}};a.fn.multiselect2side=function(g){if(q[g])return q[g].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof g||!g)return q.init.apply(this,arguments);a.error("Method "+g+" does not exist on jQuery.multiselect2side")}})(jQuery);
